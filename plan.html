<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">
  <link rel="stylesheet" type="text/css" href="./style.css">
  <link rel="icon" type="image/png" sizes="32x32" href="./assets/favicon-32x32.png">
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Barlow:wght@400;700&family=Fraunces:wght@400;700;900&display=swap" rel="stylesheet"> 
  <title>Frontend Mentor | Coffeeroasters subscription site</title>
</head>

<body id="plan" class="container">
  <header>
    <a href="index.html"><img class="logo" src="./assets/shared/desktop/logo.svg"></a>
    <nav>
      <a href="./index.html">Home</a>
      <a href="./about.html">About us</a>
      <a href="./plan.html">Create your plan</a>
    </nav>
    <img id="header__open-menu" src="./assets/shared/mobile/icon-hamburger.svg">
    <img id="header__close-menu" src="./assets/shared/mobile/icon-close.svg">
  </header>

  <section id="hero">
    <h3>Create a plan</h3>
    <p>
      Build a subscription plan that best fits your needs. We offer an assortment of the best 
      artisan coffees from around the globe delivered fresh to your door.
    </p>
    <div id="hero__image-tint"></div>
  </section>

  <section id="steps">
    <ol>
      <li>
        <div class="marker">01</div>
        <h4>Pick your coffee</h4>
        <p>Select from our evolving range of artisan coffees. Our beans are ethically
          sourced and we pay fair prices for them. There's new coffees in all profiles
          every month for you to try out.</p>
      </li>
      <li>
        <div class="marker">02</div>
        <h4>Choose the frequency</h4>
        <p>Customize your order frequency, quantity, even your roast style and grind type.
          Pause, skip or cancel your subscription with no commitment through our online portal.</p>
      </li>
      <li>
        <div class="marker">03</div>
        <h4>Receive and enjoy!</h4>
        <p>We ship your package within 48 hours, freshly roasted. Sit back and enjoy award-winning
          world-class coffees curated to provide a distinct tasting experience.</p>
      </li>
      <div class="top-border"></div>
    </ol>
  </section>

  <section id="choices">
    <div id="side-index">
      <ol>
        <li>
          <div class="item-text">
            <div class="marker">01</div> Preferences
          </div>
        </li>
        <li>
          <div class="item-text">
            <div class="marker">02</div> Bean type
          </div>
        </li>
        <li>
          <div class="item-text">
            <div class="marker">03</div> Quantity
          </div>
        </li>
        <li id="side-menu-grind-item">
          <div class="item-text">
            <div class="marker">04</div> Grind option
          </div>
        </li>
        <li>
          <div class="item-text">
            <div class="marker">05</div> Deliveries
          </div>  
        </li>
      </ol>
    </div>

    <div class="right">
      <ul class="choices-list">
        <li class="choice">
          <div class="choice-button">
            How do you drink your coffee?
          </div>
          <div class="choice-options" data-bind="method">
            <div class="choice-options-flex">
              <div class="option" data-prefix="using" data-value="Capsules">
                <h4>Capsule</h4>
                Compatible with Nespresso systems and similar brewers
              </div>
              <div class="option" data-prefix="as">
                <h4>Filter</h4>
                For pour over or drip methods like Aeropress, Chemex, and V60
              </div>
              <div class="option" data-prefix="as">
                <h4>Espresso</h4>
                Dense and finely ground beans for an intense, flavorful experience
              </div>
            </div>
          </div>
        </li>
        
        <li class="choice">
          <div class="choice-button">
            What type of coffee?
          </div>
          <div class="choice-options" data-bind="type">
            <div class="choice-options-flex">
              <div class="option">
                <h4>Single origin</h4>
                Distinct, high quality coffee from a specific family-owned farm
              </div>
              <div class="option">
                <h4>Decaf</h4>
                Just like regular coffee, except the caffeine has been removed
              </div>
              <div class="option">
                <h4>Blended</h4>
                Combination of two or three dark roasted beans of organic coffees
              </div>
            </div>
          </div>
        </li>
        
        <li class="choice">
          <div class="choice-button">
            How much would you like?
          </div>
          <div class="choice-options" data-bind="amount">
            <div class="choice-options-flex">
              <div class="option" costmod data-amount-index="0">
                <h4>250g</h4>
                Perfect for the solo drinker. Yields about 12 delicious cups.
              </div>
              <div class="option" costmod data-amount-index="1">
                <h4>500g</h4>
                Perfect option for a couple. Yields about 40 delectable cups.
              </div>
              <div class="option" costmod data-amount-index="2">
                <h4>1000g</h4>
                Perfect for offices and events. Yields about 90 delightful cups.
              </div>
            </div>
          </div>
        </li>
        
        <li class="choice">
          <div class="choice-button" id="grind-choice-button">
            Want us to grind them?
          </div>
          <div class="choice-options" data-bind="grind">
            <div class="choice-options-flex">
              <div class="option">
                <h4>Wholebean</h4>
                Best choice if you cherish the full sensory experience
              </div>
              <div class="option">
                <h4>Filter</h4>
                For drip or pour-over coffee methods such as V60 or Aeropress
              </div>
              <div class="option">
                <h4>Cafetiére</h4>
                Course ground beans specially suited for french press coffee
              </div>
            </div>
          </div>
        </li>
        
        <li class="choice">
          <div class="choice-button">
            How often should we deliver?
          </div>
          <div class="choice-options" data-bind="frequency">
            <div class="choice-options-flex">
              <div class="option" costmod data-freq-index="0">
                <h4>Every week</h4>
                <span class="shipment-cost">_____</span> per shipment. Includes free first-class shipping.
              </div>
              <div class="option" costmod data-freq-index="1">
                <h4>Every 2 weeks</h4>
                <span class="shipment-cost">_____</span> per shipment. Includes free priority shipping.
              </div>
              <div class="option" costmod data-freq-index="2">
                <h4>Every month</h4>
                <span class="shipment-cost">_____</span> per shipment. Includes free priority shipping.
              </div>
            </div>
          </div>
        </li>
      </ul>
      
    
      <section id="summary">
        <h5>Order Summary</h5>
        <div class="order-description">
          “I drink my coffee
          <span class="order-description-prefix"></span>
          <span data-bind="method">_____</span>,
          with a
          <span data-bind="type">_____</span>
          type of bean. 
          <span data-bind="amount">_____</span>
          <span class="grind-text">
            ground ala 
            <span data-bind="grind">_____</span>,
          </span>
          sent to me 
          <span data-bind="frequency">_____</span>.
        </div>
      </section>
      
      <button id="submit-plan">
        Create my plan!
      </button>
    </div>
  </section>

  <!-- Modal -->
  <div id="modal">
    <div id="modal-blur"></div>
    <div id="modal-content">
      <div class="modal-header">Order Summary</div>
      <div class="modal-body">
        <div class="order-description">
          “I drink my coffee
          <span class="order-description-prefix"></span>
          <span data-bind="method">_____</span>,
          with a
          <span data-bind="type">_____</span>
          type of bean. 
          <span data-bind="amount">_____</span>
          <span class="grind-text">
            ground ala 
            <span data-bind="grind">_____</span>,
          </span>
          sent to me 
          <span data-bind="frequency">_____</span>.
        </div>
        <p>Is this correct? You can proceed to checkout or go back to plan selection if something 
          is off. Subscription discount codes can also be redeemed at the checkout.</p>
  
        <button id="price-and-submit">
          Checkout -
          <span id="order-price">$_____/month</span>
        </button>
      </div>
    </div>
  </div>
  <!-- End modal -->

  <footer>
    <img src="./assets/shared/desktop/logo-white.svg">
    <nav>
      <a href="./index.html">Home</a>
      <a href="./about.html">About us</a>
      <a href="./plan.html">Create your plan</a>
    </nav>
    <div id="footer__socials">
      <img src="assets/shared/desktop/icon-facebook.svg">
      <img src="assets/shared/desktop/icon-twitter.svg">
      <img src="assets/shared/desktop/icon-instagram.svg">
    </div>
  </footer>
  <script src="js/jquery-3.6.0.min.js"></script>
  <script src="js/default.js"></script>
  <script>
    let optionAnimating = false;
    let costAmountIndex = -1;
    let costFreqIndex = -1;

    const COST_MATRIX = [
      [ 7.20,  9.60,  12.00],
      [13.00,  17.50, 22.00],
      [22.00,  32.00, 42.00]
    ];

    const FREQ_COST_MULTIPLIERS = [4, 2, 1];

    const getCostString = (val) => {
      const base = COST_MATRIX[costAmountIndex][costFreqIndex];
      const multiplier = FREQ_COST_MULTIPLIERS[costFreqIndex];

      return '$' + (base * multiplier).toFixed(2).toString();
    }

    $(document).ready(() => {
      $('.choice-button, #side-index li').click(function(e) {
        if (optionAnimating) return;
        const currIndex = $(this).hasClass('choice-button') ?
          $(this).closest('.choice').index() :
          $(this).index();

        const currChoiceMain = $('.choices-list .choice:eq(' + currIndex + ') .choice-button');
        const currChoiceSide = $('#side-index ol li:eq(' + currIndex + ')');
        
        const choiceOptions = $(currChoiceMain.siblings('.choice-options')[0]);
        optionAnimating = true;
        if (currChoiceMain.hasClass('active')) {
          currChoiceMain.removeClass('active');
          choiceOptions.slideUp({
            duration: 0,
            done: () => {
              optionAnimating = false;
            }
          });
          return;
        }

        $('.choice-button').each(function(e) {
          $(this).removeClass('active');
          $($(this).siblings('.choice-options')[0]).slideUp({
            duration: 0
          });
        });

        currChoiceMain.addClass('active');

        choiceOptions.slideDown({
          duration: 0,
          done: () => optionAnimating = false,
        })


        $('#side-index li').each(function() {
          $(this).removeClass('active');
        })

        currChoiceSide.addClass('active');

        if (!$(this).hasClass('choice-button')) {
          currChoiceMain.parent()[0].scrollIntoView({
          behavior: "smooth",
        });
        }
      });

      const orderDescriptions = $('.order-description');
      const freqOptions = $('.choice-options[data-bind=frequency]');

      $('.option').click(function(e) {
        const optionGroup = $(this).closest('.choice-options');

        /** 
         * PROCESS DESELECTING OPTION
         **/
        if ($(this).hasClass('selected')) {
          $(this).removeClass('selected');
          orderDescriptions
            .find('[data-bind=' + optionGroup.attr('data-bind') + ']')
            .text('_____');

            const prefix = $(this).attr('data-prefix');
            if (prefix) {
              orderDescriptions
                .find('.order-description-prefix')
                .text('');
            }

            if ($(this).attr('data-amount-index')) {
              costAmountIndex = -1;

              freqOptions.find('.shipment-cost').text('_____');
              $('#order-price').text('$_____/month');
            }

            if ($(this).attr('data-freq-index')) {
              costFreqIndex = -1;
              $('#order-price').text('$_____/month');
            }

            if ($(this).attr('data-value') == 'Capsules') {
              $('#grind-choice-button').removeClass('disabled');
              $('#side-menu-grind-item').removeClass('disabled');
              $('.grind-text').css('display', 'inline');
            }

            return;
        } 

        /** 
         * PROCESS SELECTING OPTION
         **/
        $(this).siblings().removeClass('selected');
        $(this).addClass('selected');
        
        const value = $(this).attr('data-value') ? 
          $(this).attr('data-value') : 
          $(this).find('h4').text();

        orderDescriptions
          .find('[data-bind=' + optionGroup.attr('data-bind') + ']')
          .text(value);
          
        const prefix = $(this).attr('data-prefix');
        if (prefix) {
          orderDescriptions
            .find('.order-description-prefix')
            .text(prefix);
        }


        if ($(this).attr('data-amount-index')) {
          costAmountIndex = parseInt($(this).attr('data-amount-index'));

          freqOptions.find('.shipment-cost').each(function(index) {
            $(this).text(
              '$' + COST_MATRIX[costAmountIndex][index].toFixed(2)
              );
          });
        }

        if ($(this).attr('data-freq-index')) {
          costFreqIndex = parseInt($(this).attr('data-freq-index'));
        }

        if ($(this).closest('.choice-options').attr('data-bind') == 'method') {
          if ($(this).attr('data-value') == 'Capsules') {
            $('#grind-choice-button').addClass('disabled');
            $('#side-menu-grind-item').addClass('disabled');
            $('.grind-text').css('display', 'none');
          } else {
            $('#grind-choice-button').removeClass('disabled');
            $('#side-menu-grind-item').removeClass('disabled');
            $('.grind-text').css('display', 'inline');
          }
        }

        if (
          costAmountIndex >= 0 &&
          costFreqIndex >= 0
          ) {
            $('#order-price').text(
              getCostString()
            );
        }
      });

      $('#submit-plan, #modal-blur').click(() => {
        $('#modal').toggleClass('active');
      });
    })
  </script>
</body>

</html>